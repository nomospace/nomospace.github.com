<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="author" content="nomospace" />
<meta name="keywords" content="" />
<meta property="wb:webmaster" content="9d4b91032648dbe0" />
<title>挪墨的空间 / 改善用户体验：图片的预加载[翻译]</title>
<link href="http://nomospace.github.com/feed.xml" rel="alternate" title="挪墨的空间" type="application/atom+xml" />
<link rel="stylesheet" type="text/css" href="/assets/css/site.css" />
<link rel="stylesheet" type="text/css" href="/assets/css/code/github.css" />

<!--[if IE]>
<script src="/assets/js/html5.js"></script>
<![endif]-->
</head>

<body class="page-type-post" data-name="">
<div class="main">
	<div class="trace">/ <a href="/">挪墨的空间</a> / 改善用户体验：图片的预加载[翻译]</div>

<article>
	<h1><a href="/posts/image-preload.html">改善用户体验：图片的预加载[翻译]</a></h1>
	
	<p class="meta">
	<span class="datetime">2011-03-16</span> posted in [<a href="/category/javascript" class="category">javascript</a>]
</p>
	<div class="bct fc05 fc11 nbw-blog ztag js-fs2">本文地址：<a target="_blank" href="http://blog.163.com/jinlu_hz/blog/static/1138301522011216114141761/">http://blog.163.com/jinlu_hz/blog/static/1138301522011216114141761/</a><br>原文地址：<a target="_blank" rel="nofollow" href="http://msdn.microsoft.com/en-us/scriptjunkie/gg681862.aspx">http://msdn.microsoft.com/en-us/scriptjunkie/gg681862.aspx</a><br>原文作者：<a target="_blank" rel="nofollow" href="http://twitter.com/lehmjan">Jan Lehmann</a><br><br>翻译能力有限，辞不达意的地方请自动跳过或者直接阅读<a target="_blank" rel="nofollow" href="http://msdn.microsoft.com/en-us/scriptjunkie/gg681862.aspx">原文</a>。<br><br>——以下为翻译——<br><br>目前对打造一个操作系统桌面般用户体验的关注度日益升高，用到的图片数量也越来越庞大。为了满足各种需求，对话框、标签栏、工具条、幻灯与日历组件等变得十分重要。<br>图片的预加载能够提升网站性能和可用性，同时也避免了一些页面的因图片未加载完毕而产生的闪烁感和片段感。<br><br><br><b>Frequently used Techniques（惯用伎俩）</b><br><br>有两种惯用伎俩实现图片预加载：<br><b><font color="#808080">Css sprites</font></b><br>Css sprites有效限制了页面上的HTTP请求数，所有的小图片被拼在了一张大图片上，然后通过CSS来定位相应元素。<br>但有一个缺点，只有刚开始时（页面第一次载入时）出现的图片会被影响到。其他那些动态载入、计划稍后呈现的图片不会被加载，在此产生了一个延迟。所以这个技术的目标与静态网站一致，大大降低图片数量。<br><br><b><font color="#808080">JavaScript</font></b><br>另一个手段就是JavaScript了，无非就是将每个图片的URL塞进一个数组。<br><br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 19px; white-space: pre-wrap;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;myImages&nbsp;=&nbsp;["image_1.jpg<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">',&nbsp;'</span>image_2.jpg<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">',&nbsp;'</span>image_3.jpg',&nbsp;...];</span></span><br><br>然后循环数组，为每个URL创建一个image对象。这么做的好处是保证所有的图片都已经被浏览器缓存完毕，并能够毫无延迟地为浏览器后期所用。<br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 16px; white-space: pre-wrap;"><ol style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 12px 0px 12px 24px; outline-width: 0px; padding: 0px; line-height: 19px;"><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">for</span>&nbsp;(<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;i&nbsp;=&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">0</span>;&nbsp;i&nbsp;&lt;=&nbsp;myImages.length;&nbsp;i++)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;img&nbsp;=&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: rgb(65, 105, 225);">new</span>&nbsp;Image();&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img.src&nbsp;=&nbsp;myImages[i];</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li></ol></span></span>该解决方案的时间开销都用在了将每一个图片URL放进一个数组中去，并维护数组的一致性。网站每次修改（例如新增了图片或者图片的URL改变）都会影响数组，如果有无数图片要修改那么这个操作将非常耗时。<br><br><br><br><b>Automated image preloading with progress indicator（带有载入进度指示的图片自动预加载）</b><br><br>一个更有效的手段是自动收集图片URL。<br>第一步是分析页面上所有CSS link和内联样式。通过遍历"document.styleSheets"对象成员，访问每一个正在使用的样式表。<br><br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 19px; white-space: pre-wrap;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">for</span>&nbsp;(<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;i&nbsp;=&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">0</span>;&nbsp;i&nbsp;&lt;&nbsp;document.styleSheets.length;&nbsp;i++)<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></span></span><br><br>获取Css的基础路径很重要，这是为后期获取图片的绝对路径做准备。<br><br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 19px; white-space: pre-wrap;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;baseURL&nbsp;=&nbsp;getBaseURL(document.styleSheets[i].href);</span></span><br><br>出于浏览器兼容性考虑，很有必要检测是否每个样式表的"cssRules"或者"rules"都含有数据。<br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 16px; white-space: pre-wrap;"><ol style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 12px 0px 12px 24px; outline-width: 0px; padding: 0px; line-height: 19px;"><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">if</span>&nbsp;(document.styleSheets[i].cssRules)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;cssRules&nbsp;=&nbsp;document.styleSheets[i].cssRules</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">else</span>&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">if</span>&nbsp;(document.styleSheets[i].rules)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;cssRules&nbsp;=&nbsp;document.styleSheets[i].rules</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li></ol></span></span><br>每条Css规则会被解析是否为空值，或者说是否为一个与图片相关的规则。正则表达式正好能够做这个事情。<br><br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 19px; white-space: pre-wrap;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;cssRule&nbsp;=&nbsp;cssRules[j].style.cssText.match(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: maroon;">/[^\(]+\.(gif|jpg|jpeg|png)/g</span>);</span></span><br><br>然后，获取到的每个图片的URL会被塞进数组为后期所用。<br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 16px; white-space: pre-wrap;"><ol style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 12px 0px 12px 24px; outline-width: 0px; padding: 0px; line-height: 19px;"><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: rgb(65, 105, 225);">function</span>&nbsp;analyzeCSSFiles()&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;cssRules;&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;CSS&nbsp;rules</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">for</span>&nbsp;(<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;i&nbsp;=&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">0</span>;&nbsp;i&nbsp;&lt;&nbsp;document.styleSheets.length;&nbsp;i++)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span>&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;loop&nbsp;through&nbsp;all&nbsp;linked/inline&nbsp;stylesheets</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;baseURL&nbsp;=&nbsp;getBaseURL(document.styleSheets[i].href);&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;get&nbsp;stylesheet's&nbsp;base&nbsp;URL&nbsp;</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;get&nbsp;CSS&nbsp;rules</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">if</span>&nbsp;(document.styleSheets[i].cssRules)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cssRules&nbsp;=&nbsp;document.styleSheets[i].cssRules</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">else</span>&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">if</span>&nbsp;(document.styleSheets[i].rules)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cssRules&nbsp;=&nbsp;document.styleSheets[i].rules</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;loop&nbsp;through&nbsp;all&nbsp;CSS&nbsp;rules</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">for</span>&nbsp;(<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;j&nbsp;=&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">0</span>;&nbsp;j&nbsp;&lt;&nbsp;cssRules.length;&nbsp;j++)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">if</span>&nbsp;(cssRules[j].style&nbsp;&amp;&amp;&nbsp;cssRules[j].style.cssText)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;extract&nbsp;only&nbsp;image&nbsp;related&nbsp;CSS&nbsp;rules&nbsp;</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;parse&nbsp;rules&nbsp;string&nbsp;and&nbsp;extract&nbsp;image&nbsp;URL</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;cssRule&nbsp;=&nbsp;cssRules[j].style.cssText.match(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: maroon;">/[^\(]+\.(gif|jpg|jpeg|png)/g</span>);</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">if</span>&nbsp;(cssRule)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;add&nbsp;image&nbsp;URL&nbsp;to&nbsp;array</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cssRule&nbsp;=&nbsp;(cssRule&nbsp;+&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">""</span>).replace(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"\""</span>,&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">""</span>)</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageURLs.push(baseURL&nbsp;+&nbsp;cssRule);</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li></ol></span></span><br>为获取每个图片的绝对路径，在此实现一个"getBaseUrl"的函数用来提取每个Css文件里的绝对路径。<br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 16px; white-space: pre-wrap;"><ol style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 12px 0px 12px 24px; outline-width: 0px; padding: 0px; line-height: 19px;"><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: rgb(65, 105, 225);">function</span>&nbsp;getBaseURL(cssLink)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;cssLink&nbsp;=&nbsp;(cssLink)&nbsp;?&nbsp;cssLink&nbsp;:&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">'window.location.href'</span>;&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;window.location.href&nbsp;for&nbsp;inline&nbsp;style&nbsp;definitions</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;urlParts&nbsp;=&nbsp;cssLink.split(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">'/'</span>);&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;split&nbsp;link&nbsp;at&nbsp;'/'&nbsp;into&nbsp;an&nbsp;array</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;urlParts.pop();&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;remove&nbsp;file&nbsp;path&nbsp;from&nbsp;URL&nbsp;array</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;baseURL&nbsp;=&nbsp;urlParts.join(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">'/'</span>);&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;create&nbsp;base&nbsp;URL&nbsp;(rejoin&nbsp;URL&nbsp;parts)</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">if</span>&nbsp;(baseURL&nbsp;!=&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">""</span>)&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;baseURL&nbsp;+=&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">'/'</span>;&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;expand&nbsp;URL&nbsp;with&nbsp;a&nbsp;'/'</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">return</span>&nbsp;baseURL;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li></ol></span></span><br>通过遍历集合，为页面上的每个图片创建一个image对象用以预加载，使得浏览器能够事先缓存住这些图片。切记这边使用"setTimeout"来确保每个图片在加载下一个前被完全加载，因为许多浏览器无法同时处理2个以上的请求。为避免可能出现的停顿现象，我们在此为"load","onreadystatechange"以及"error"事件增加一个处理函数。假如缺失的图片不能被正常加载，那么"errorTimer"会做一些弥补工作。<br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 16px; white-space: pre-wrap;"><ol style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 12px 0px 12px 24px; outline-width: 0px; padding: 0px; line-height: 19px;"><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: rgb(65, 105, 225);">function</span>&nbsp;preloadImages()&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">if</span>&nbsp;(imageURLs&nbsp;&amp;&amp;&nbsp;imageURLs.length&nbsp;&amp;&amp;&nbsp;imageURLs[imagesLoaded])&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span>&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;if&nbsp;image&nbsp;URLs&nbsp;array&nbsp;isn't&nbsp;empty</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;img&nbsp;=&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: rgb(65, 105, 225);">new</span>&nbsp;Image();&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;create&nbsp;a&nbsp;new&nbsp;imgage&nbsp;object</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img.src&nbsp;=&nbsp;imageURLs[imagesLoaded];&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;set&nbsp;the&nbsp;image&nbsp;source&nbsp;to&nbsp;the&nbsp;extracted&nbsp;image&nbsp;URL</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout(<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: rgb(65, 105, 225);">function</span>&nbsp;()&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">if</span>&nbsp;(!img.complete)&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jQuery(img).bind(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">'onreadystatechange&nbsp;load&nbsp;error'</span>,&nbsp;onImageLoaded);&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;bind&nbsp;event&nbsp;handler</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span>&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">else</span>&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onImageLoaded();&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;image&nbsp;loaded&nbsp;successfully,&nbsp;continue&nbsp;with&nbsp;the&nbsp;next&nbsp;one</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errorTimer&nbsp;=&nbsp;setTimeout(onImageLoaded,&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">1000</span>);&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;handle&nbsp;missing&nbsp;files&nbsp;(load&nbsp;the&nbsp;next&nbsp;image&nbsp;after&nbsp;1&nbsp;second)</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span>,&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">25</span>);</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">else</span>&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showPreloadedImages();</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: rgb(65, 105, 225);">function</span>&nbsp;onImageLoaded()&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;clearTimeout(errorTimer);&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;clear&nbsp;error&nbsp;timer</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;imagesLoaded++;&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;increase&nbsp;image&nbsp;counter</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;preloadImages();&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;preload&nbsp;next&nbsp;image</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li></ol></span></span><br>为改善用户体验，我们修改"onImageLoaded"事件处理函数，目的与进度条进行交互。<br>首先，为显示进度条而加载jQuery UI样式表和所需的javascript文件：<br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 16px; white-space: pre-wrap;"><ol style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 12px 0px 12px 24px; outline-width: 0px; padding: 0px; line-height: 19px;"><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&lt;link&nbsp;type=<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"text/css"</span>&nbsp;href=<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"css/ui-lightness/jquery-ui-1.8.6.custom.css"</span>&nbsp;rel=<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"stylesheet"</span>&nbsp;/&gt;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&lt;script&nbsp;type=<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"text/javascript"</span>&nbsp;src=<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"js/jquery-1.4.2.min.js"</span>&gt;&lt;/script&gt;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&lt;script&nbsp;type=<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"text/javascript"</span>&nbsp;src=<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"js/jquery-ui-1.8.6.custom.min.js"</span>&gt;&lt;/script&gt;</li></ol></span></span><br>然后初始化进度条：<br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 16px; white-space: pre-wrap;"><ol style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 12px 0px 12px 24px; outline-width: 0px; padding: 0px; line-height: 19px;"><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">$(document).ready(<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: rgb(65, 105, 225);">function</span>&nbsp;()&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;$(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"#progressbar"</span>).progressbar(<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span>&nbsp;value:&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">0</span>&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span>);&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;initialize&nbsp;progress&nbsp;bar</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span>);</li></ol></span></span><br>最后，扩展"onImageLoaded"事件处理函数。每个图片在加载完毕后，进度条会重新计算进度，调整UI。<br>这个预加载函数的成功之处在于每个图片都被加载到了页面，在整个加载操作完成之后，所有的图片会同时呈现在页面上。<br><span style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><span style="border-collapse: collapse; color: rgb(51, 51, 51); font-family: 'Courier New',Courier,monospace; font-size: 13px; line-height: 16px; white-space: pre-wrap;"><ol style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 12px 0px 12px 24px; outline-width: 0px; padding: 0px; line-height: 19px;"><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: rgb(65, 105, 225);">function</span>&nbsp;onImageLoaded()&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;clearTimeout(errorTimer);&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;clear&nbsp;error&nbsp;timer</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;$(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"#imagelist"</span>).append(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"&lt;span&gt;"</span>&nbsp;+&nbsp;imagesLoaded&nbsp;+&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">":&nbsp;&lt;/span&gt;&lt;img&nbsp;src='http://blog.163.com/jinlu_hz/blog/"</span>&nbsp;+&nbsp;imageURLs[imagesLoaded]&nbsp;+&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"'/&gt;"</span>);&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;append&nbsp;image&nbsp;tag&nbsp;to&nbsp;image&nbsp;list</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;imagesLoaded++;&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;increase&nbsp;image&nbsp;counter</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: navy;">var</span>&nbsp;percent&nbsp;=&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: olive;">parseInt</span>(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">100</span>&nbsp;*&nbsp;imagesLoaded&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: maroon;">/&nbsp;(imageURLs.length&nbsp;-&nbsp;1));&nbsp;/</span>/&nbsp;calculate&nbsp;progress</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;$(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"#progressbar"</span>).progressbar(<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">{</span>&nbsp;value:&nbsp;percent&nbsp;<span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span>);&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;refresh&nbsp;progress&nbsp;bar</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;$(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"#progressbarTitle"</span>).text(<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"Preloading&nbsp;progress:&nbsp;"</span>&nbsp;+&nbsp;percent&nbsp;+&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: teal;">"%"</span>);&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;</li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;">&nbsp;&nbsp;&nbsp;&nbsp;preloadImages();&nbsp;<span style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: green;">//&nbsp;preload&nbsp;next&nbsp;image</span></li><li style="border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px 0px 3px; list-style-image: none;"><span style="border-width: 0px; font-weight: bold; font-style: inherit; font-family: inherit; margin: 0px; outline-width: 0px; padding: 0px; color: red;">}</span></li></ol></span></span><br><b>A small step to get better（还能做的更好）</b><br>预加载图片是一个改善用户体验，使网站显得更为专业的一个简单手段。通过程序自动分析Css规则，你能够不费力气的处理大量图片。<br>进度条提示用户大概还要等待加载的时间，有效提高了用户满意度。jQuery还提供了许多像进度条一样超棒的插件，使用这些插件无疑能使你的网站蓬荜生辉。<br><br><a target="_blank" rel="nofollow" href="http://gallery.msdn.microsoft.com/scriptjunkie/Improving-User-Experience-7a95c238">这个链接</a>包含本文所有实例，你可以略作修改再整合到自己的项目中去。<br><br><br>——翻译结束——<br>2011-03-16 12:18:35</div>


	
	<!--<p class="permalink">永久链接：<a href="http://nomospace.github.io/posts/image-preload.html">http://nomospace.github.io/posts/image-preload.html</a></p>-->
</article>
<div id="disqus_thread" class="comments"></div>

	<footer>
		<p>&copy; Since 2012 <a href="http://github.com/nomospace" target="_blank">github.com/nomospace</a></p>
	</footer>
</div>

<aside>
	<h2><a href="/">挪墨的空间</a><a href="/feed.xml" class="feed-link" title="RSS订阅"><img width="15" src="/assets/images/feedicon.png" alt="RSS feed" /></a></h2>
	<div class="block block-about">
	  <h3>分类</h3>
		<ul>
		<li class="javascript"><a href="/category/javascript/">javascript</a></li>
		<li class="node"><a href="/category/node/">node</a></li>
		<li class="css"><a href="/category/css/">css</a></li>
		<li class="html5"><a href="/category/html5/">html5</a></li>
		<li class="frontend"><a href="/category/frontend/">frontend</a></li>
		
		</ul>
	</div>

	<form action="/search/" class="block block-search">
		<h3>搜索</h3>
    <input type="search" name="q" placeholder="输入关键词按回车搜索" />
	</form>

	<div class="block block-about">
		<h3><a href="/douban">我的豆瓣</a></h3>
	</div>

	<div class="block block-about">
		<h3><a href="/projects">我的项目</a></h3>
	</div>

	<div class="block block-about" style="display:none;">
    <h3>关于</h3>
		<figure>
			<img src="http://www.gravatar.com/avatar/d6e8639fcaea0c7c0fab106033f05de0?s=80" />
			<figcaption><strong>nomospace</strong></figcaption>
		</figure>
	</div>

	<a style="display:none;" href="https://github.com/nomospace/nomospace.github.com" class="forkme"><img src="/assets/images/forkmeongithub.png" alt="Fork me on GitHub"></a>

    <div class="block block-license">
        <h3>版权申明</h3>
        <p><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/cn/" target="_blank" class="hide-target-icon" title="Copyright declaration of site content"><img alt="知识共享许可协议" src="http://i.creativecommons.org/l/by-nc-nd/2.5/cn/88x31.png" /></a></p>
    </div>

	<div class="block block-thank">
        <h3>Powered by</h3>
        <p>
            <a href="http://disqus.com/" target="_blank">Disqus</a>,
            <a href="http://www.google.com/cse/" target="_blank">Google Custom Search</a>,
            <a href="https://github.com/" target="_blank">GitHub</a>,
            <a href="http://en.gravatar.com/" target="_blank">Gravatar</a>,
            <a href="http://softwaremaniacs.org/soft/highlight/en/">HighlightJS</a>,
            <a href="https://github.com/mojombo/jekyll" target="_blank">jekyll</a>,
            <a href="https://github.com/mytharcher/SimpleGray" target="_blank">SimpleGray</a>
        </p>
    </div>
</aside>

<script src="/assets/js/highlight.js"></script>
<script src="/assets/js/hljs/languages/css.js"></script>
<script src="/assets/js/hljs/languages/xml.js"></script>
<script src="/assets/js/hljs/languages/javascript.js"></script>
<script src="/assets/js/hljs/languages/ruby.js"></script>
<script src="/assets/js/jquery-1.8.0.min.js"></script>

    <script src="http://nomospace.disqus.com/embed.js"></script>

<script src="/assets/js/site.js"></script>
<script>
    var _errs=["4fcf6a84a57ce4043f00032a"];(function(a,b){a.onerror=function(){_errs.push(arguments)};
    var d=function(){var a=b.createElement("script"),c=b.getElementsByTagName("script")[0];
    a.src="//d15qhc0lu1ghnk.cloudfront.net/beacon.js";a.async=!0;
    c.parentNode.insertBefore(a,c)};a.addEventListener?a.addEventListener("load",d,!1):
    a.attachEvent("onload",d)})(window,document);
</script>
<script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31926992-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F98b0bb1f70082dc53d1cfaafd343ce0c' type='text/javascript'%3E%3C/script%3E"));
</script>
</body>
</html>
